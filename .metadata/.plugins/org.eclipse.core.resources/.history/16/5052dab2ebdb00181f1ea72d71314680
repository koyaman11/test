package com.internousdev.ecsite.action;

import java.util.Map;
import java.util.ArrayList;
import org.apache.struts2.interceptor.SessionAware;
import com.internousdev.ecsite.dao.ItemListDAO;
import com.internousdev.ecsite.dto.ItemListDTO;
import com.opensymphony.xwork2.ActionSupport;


public class ItemListDeleteConfirmAction extends ActionSupport implements SessionAware{
	public Map<String,Object> session;
	private ItemListDAO itemListDAO=new ItemListDAO();
	private ArrayList<ItemListDTO> itemListDTO=new ArrayList<ItemListDTO>();
	private String deleteFlg;
	private String message;

	public String execute() throws SQLException{
		if(!session.containsKey("item_name")){
			return ERROR;
		}
		if(deleteFlg==null){
			String item_info_transaction=session.get("item_name").toString();
			itemListDTO=itemListDAO.getItemListInfo();
		}else if(deleteFlg.equals("1")){
			delete();
		}
		String result=SUCCESS;
		return result;
	}

	public void delete()throws SQLException{
		String item_info_transaction=session.get("item_name").toString();

		int res=itemListDTO.itemListHistoryDelete(item_info_transaction);
		if(res>0){
			itemListDTO=null;
			setMessage("消去しました");
		}else if(res==0){
			setMessage("消去できませんでした");
		}
		public void setDeleteFlg(String deleteFlg){
			this.deleteFlg=deleteFlg;
		}
		public void setSession(Map<String,Object>session){
			this.session=session;
		}

		public ArrayList<ItemListDTO>getItemListDTO(){
			return this.itemListDTO;
		}
		public String getMessage(){
			return this.message;
		}
		public void setMessage(String mesaage){
			this.message=message;
		}
	}




}
